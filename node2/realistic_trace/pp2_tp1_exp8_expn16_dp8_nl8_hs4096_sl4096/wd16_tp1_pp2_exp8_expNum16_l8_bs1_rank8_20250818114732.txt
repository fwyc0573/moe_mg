rank:8:recv_forward(stage_id=1,batch_id=0,mg_state=help,duration=77.29,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985856812.5,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=0,mg_state=steady,duration=0.51,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856813.42,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=0,mg_state=steady,duration=80.93,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856894.4,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.17,timestamp=3985856817.29,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3985856819.02,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.92,timestamp=3985856832.63,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.26,timestamp=3985856836.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3985856838.12,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.56,timestamp=3985856851.35,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.63,timestamp=3985856854.78,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985856856.33,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.12,timestamp=3985856870.09,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.3,timestamp=3985856873.27,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3985856874.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.96,timestamp=3985856888.54,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=0,mg_state=steady,duration=0.57,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856895.07,sub_operations=['trace_src_func=allreduce,duration=0.24,timestamp=3985856894.97,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=0,mg_state=steady,duration=138.36,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857033.61,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3985856903.5,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.85,timestamp=3985856931.03,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.06,timestamp=3985856935.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.86,timestamp=3985856963.42,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.09,timestamp=3985856968.36,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.48,timestamp=3985856996.51,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.39,timestamp=3985857001.71,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.96,timestamp=3985857030.34,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=0,mg_state=steady,duration=2.28,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857036.02,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=1,mg_state=steady,duration=2.28,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857036.02,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=1,mg_state=steady,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857036.67,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=1,mg_state=steady,duration=82.84,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857119.56,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.83,timestamp=3985857040.22,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3985857041.85,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=9.09,timestamp=3985857056.73,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.2,timestamp=3985857061.45,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3985857063.15,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.97,timestamp=3985857076.84,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.42,timestamp=3985857080.1,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.04,timestamp=3985857081.84,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.55,timestamp=3985857095.06,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.6,timestamp=3985857098.39,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3985857100.08,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.96,timestamp=3985857113.69,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=1,mg_state=steady,duration=0.57,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857120.23,sub_operations=['trace_src_func=allreduce,duration=0.26,timestamp=3985857120.13,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=1,mg_state=steady,duration=139.8,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857260.41,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.04,timestamp=3985857128.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.73,timestamp=3985857156.38,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3985857161.29,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.24,timestamp=3985857189.21,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.81,timestamp=3985857194.96,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.23,timestamp=3985857223.85,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.14,timestamp=3985857228.96,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.39,timestamp=3985857257.03,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=1,mg_state=steady,duration=2.23,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857262.75,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=2,mg_state=steady,duration=2.23,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857262.75,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=2,mg_state=steady,duration=0.52,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857263.39,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=2,mg_state=steady,duration=81.21,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857344.65,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.85,timestamp=3985857266.96,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985857268.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.19,timestamp=3985857282.5,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.61,timestamp=3985857286.73,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.0,timestamp=3985857288.44,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.01,timestamp=3985857302.13,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.3,timestamp=3985857305.25,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985857306.88,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.02,timestamp=3985857320.57,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.17,timestamp=3985857323.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.82,timestamp=3985857324.96,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.17,timestamp=3985857338.78,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=2,mg_state=steady,duration=0.55,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857345.3,sub_operations=['trace_src_func=allreduce,duration=0.22,timestamp=3985857345.2,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=2,mg_state=steady,duration=139.36,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857485.05,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3985857353.88,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.85,timestamp=3985857381.42,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.8,timestamp=3985857386.35,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.88,timestamp=3985857413.94,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3985857418.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.75,timestamp=3985857448.42,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.21,timestamp=3985857453.6,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.38,timestamp=3985857481.66,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=2,mg_state=steady,duration=2.18,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857487.32,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=3,mg_state=steady,duration=2.18,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857487.32,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=3,mg_state=steady,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857487.99,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=3,mg_state=steady,duration=81.73,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857569.77,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.07,timestamp=3985857491.8,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3985857493.49,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.95,timestamp=3985857507.15,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.48,timestamp=3985857511.16,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3985857512.87,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.04,timestamp=3985857526.59,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.37,timestamp=3985857529.74,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.0,timestamp=3985857531.44,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.98,timestamp=3985857545.08,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.75,timestamp=3985857548.52,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.0,timestamp=3985857550.22,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.03,timestamp=3985857563.9,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=3,mg_state=steady,duration=0.63,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857570.49,sub_operations=['trace_src_func=allreduce,duration=0.31,timestamp=3985857570.4,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=3,mg_state=steady,duration=139.31,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857710.18,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.04,timestamp=3985857579.18,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.87,timestamp=3985857606.74,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3985857611.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.38,timestamp=3985857639.75,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.17,timestamp=3985857644.87,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.1,timestamp=3985857672.64,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.35,timestamp=3985857677.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.19,timestamp=3985857706.8,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=3,mg_state=steady,duration=2.23,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857712.5,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=4,mg_state=steady,duration=2.23,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857712.5,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=4,mg_state=steady,duration=0.47,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857713.1,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=4,mg_state=steady,duration=80.7,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857793.85,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.0,timestamp=3985857716.82,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.85,timestamp=3985857718.39,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.7,timestamp=3985857732.75,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.7,timestamp=3985857736.19,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3985857737.81,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.15,timestamp=3985857751.65,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.23,timestamp=3985857754.59,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3985857756.28,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.05,timestamp=3985857770.0,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.29,timestamp=3985857772.98,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3985857774.65,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.69,timestamp=3985857787.99,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=4,mg_state=steady,duration=1.15,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857795.09,sub_operations=['trace_src_func=allreduce,duration=0.83,timestamp=3985857794.99,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=4,mg_state=steady,duration=141.71,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857937.17,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3985857803.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.24,timestamp=3985857831.62,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.39,timestamp=3985857836.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.96,timestamp=3985857866.57,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.38,timestamp=3985857871.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.0,timestamp=3985857900.58,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.14,timestamp=3985857905.66,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.47,timestamp=3985857933.8,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=4,mg_state=steady,duration=2.16,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857939.43,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=5,mg_state=steady,duration=2.16,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857939.43,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=5,mg_state=steady,duration=0.51,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857940.06,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=5,mg_state=steady,duration=82.65,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858022.76,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.98,timestamp=3985857943.85,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985857945.53,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=9.5,timestamp=3985857960.69,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3985857963.61,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3985857965.29,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.96,timestamp=3985857978.88,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857983.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3985857985.13,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.86,timestamp=3985857998.66,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.2,timestamp=3985858001.64,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.84,timestamp=3985858003.18,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.06,timestamp=3985858016.9,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=5,mg_state=steady,duration=0.44,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858023.31,sub_operations=['trace_src_func=allreduce,duration=0.12,timestamp=3985858023.21,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=5,mg_state=steady,duration=139.64,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858163.32,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3985858031.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.37,timestamp=3985858059.14,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3985858064.43,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.56,timestamp=3985858091.69,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.62,timestamp=3985858097.34,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.97,timestamp=3985858126.0,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.06,timestamp=3985858131.36,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.5,timestamp=3985858159.69,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=5,mg_state=steady,duration=2.32,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858165.78,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=6,mg_state=steady,duration=2.32,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858165.78,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=6,mg_state=steady,duration=0.58,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858166.55,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=6,mg_state=steady,duration=79.92,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858246.51,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.21,timestamp=3985858169.82,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3985858171.57,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.95,timestamp=3985858185.17,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.88,timestamp=3985858188.93,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3985858190.62,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.95,timestamp=3985858204.24,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.16,timestamp=3985858207.14,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3985858208.82,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.92,timestamp=3985858222.41,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.19,timestamp=3985858225.33,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3985858227.04,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.92,timestamp=3985858240.64,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=6,mg_state=steady,duration=0.55,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858247.15,sub_operations=['trace_src_func=allreduce,duration=0.22,timestamp=3985858247.06,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=6,mg_state=steady,duration=138.75,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858386.32,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985858255.62,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.86,timestamp=3985858283.18,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.74,timestamp=3985858288.12,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.18,timestamp=3985858316.03,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.07,timestamp=3985858321.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.75,timestamp=3985858349.64,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3985858354.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.59,timestamp=3985858382.91,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=6,mg_state=steady,duration=2.3,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858388.71,sub_operations=[])
rank:8:recv_forward(stage_id=1,batch_id=7,mg_state=steady,duration=2.3,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858388.71,sub_operations=[])
rank:8:get_batch(stage_id=1,batch_id=7,mg_state=steady,duration=0.46,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858389.28,sub_operations=[])
rank:8:forward_step(stage_id=1,batch_id=7,mg_state=steady,duration=79.72,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858469.05,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.73,timestamp=3985858392.73,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3985858394.41,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.05,timestamp=3985858408.11,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.19,timestamp=3985858410.99,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3985858412.71,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.02,timestamp=3985858426.48,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985858429.51,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985858431.08,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.1,timestamp=3985858444.84,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.18,timestamp=3985858447.85,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985858449.43,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.09,timestamp=3985858463.18,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:loss_func(stage_id=1,batch_id=7,mg_state=steady,duration=0.7,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858469.85,sub_operations=['trace_src_func=allreduce,duration=0.37,timestamp=3985858469.75,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:8:backward_step(stage_id=1,batch_id=7,mg_state=steady,duration=140.17,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858610.34,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985858478.32,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.0,timestamp=3985858506.17,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.82,timestamp=3985858511.0,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.66,timestamp=3985858539.44,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.25,timestamp=3985858544.65,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.2,timestamp=3985858572.53,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.37,timestamp=3985858577.86,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.31,timestamp=3985858606.88,input__shape=[9734, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:8:send_backward(stage_id=1,batch_id=7,mg_state=steady,duration=2.09,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858612.54,sub_operations=[])
rank:8:dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=14.06,description=Regular DP gradient synchronization (non-expert parameters),group_kind=dp,input__shape=[374116352],input__dtype=torch.float32,timestamp=3985858626.67,sub_operations=[])
rank:8:ep_dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=5.65,description=Expert DP gradient synchronization (expert parameters),group_kind=ep_dp,input__shape=[1409286144],input__dtype=torch.float32,timestamp=3985858632.36,sub_operations=[])
rank:8:optimizer_step(stage_id=1,batch_id=0,mg_state=finalize,duration=33.41,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858665.97,sub_operations=[])
