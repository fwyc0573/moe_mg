rank:10:recv_forward(stage_id=1,batch_id=0,mg_state=help,duration=77.09,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985856811.76,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=0,mg_state=steady,duration=0.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856812.79,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=0,mg_state=steady,duration=81.52,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856894.38,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.54,timestamp=3985856817.3,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985856818.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.35,timestamp=3985856832.18,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.31,timestamp=3985856836.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985856838.14,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.71,timestamp=3985856851.75,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985856854.78,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.05,timestamp=3985856856.55,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.64,timestamp=3985856870.08,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.16,timestamp=3985856873.31,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.87,timestamp=3985856874.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.79,timestamp=3985856888.54,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=0,mg_state=steady,duration=0.59,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985856895.07,sub_operations=['trace_src_func=allreduce,duration=0.26,timestamp=3985856894.97,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=0,mg_state=steady,duration=138.39,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857033.64,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985856903.53,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.57,timestamp=3985856931.04,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3985856935.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.59,timestamp=3985856963.42,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.06,timestamp=3985856968.37,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.19,timestamp=3985856996.5,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.37,timestamp=3985857001.71,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.71,timestamp=3985857030.34,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=0,mg_state=steady,duration=1.48,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857035.38,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=1,mg_state=steady,duration=1.48,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857035.38,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=1,mg_state=steady,duration=0.6,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857036.1,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=1,mg_state=steady,duration=83.47,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857119.63,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.17,timestamp=3985857040.24,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985857041.92,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.83,timestamp=3985857056.82,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985857061.52,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985857063.15,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.8,timestamp=3985857076.86,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857080.14,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.8,timestamp=3985857081.67,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.91,timestamp=3985857095.43,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3985857098.4,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3985857100.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.78,timestamp=3985857113.7,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=1,mg_state=steady,duration=0.5,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857120.24,sub_operations=['trace_src_func=allreduce,duration=0.16,timestamp=3985857120.14,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=1,mg_state=steady,duration=139.68,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857260.45,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985857128.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.43,timestamp=3985857156.38,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.79,timestamp=3985857161.38,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.2,timestamp=3985857189.61,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.22,timestamp=3985857194.95,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.91,timestamp=3985857223.86,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.04,timestamp=3985857228.96,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.11,timestamp=3985857257.03,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=1,mg_state=steady,duration=1.5,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857262.07,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=2,mg_state=steady,duration=1.5,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857262.07,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=2,mg_state=steady,duration=0.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857262.8,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=2,mg_state=steady,duration=81.8,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857344.66,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.14,timestamp=3985857266.97,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.89,timestamp=3985857268.63,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.96,timestamp=3985857282.61,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857286.77,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.85,timestamp=3985857288.39,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.83,timestamp=3985857302.13,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985857305.29,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985857306.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.79,timestamp=3985857320.56,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985857323.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985857325.11,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.8,timestamp=3985857338.77,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=2,mg_state=steady,duration=0.59,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857345.35,sub_operations=['trace_src_func=allreduce,duration=0.22,timestamp=3985857345.24,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=2,mg_state=steady,duration=139.17,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857485.05,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.75,timestamp=3985857354.0,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.45,timestamp=3985857381.42,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985857386.29,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.68,timestamp=3985857413.93,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.09,timestamp=3985857418.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.45,timestamp=3985857448.43,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.23,timestamp=3985857453.62,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.07,timestamp=3985857481.66,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=2,mg_state=steady,duration=1.47,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857486.63,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=3,mg_state=steady,duration=1.47,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857486.63,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=3,mg_state=steady,duration=0.6,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857487.35,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=3,mg_state=steady,duration=82.36,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857569.77,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.52,timestamp=3985857491.81,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985857493.51,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.73,timestamp=3985857507.26,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857511.21,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985857512.88,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.64,timestamp=3985857526.58,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857529.78,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985857531.43,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.77,timestamp=3985857545.08,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.63,timestamp=3985857548.52,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3985857550.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.83,timestamp=3985857563.89,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=3,mg_state=steady,duration=0.63,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857570.5,sub_operations=['trace_src_func=allreduce,duration=0.28,timestamp=3985857570.4,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=3,mg_state=steady,duration=139.32,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857710.5,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.71,timestamp=3985857579.31,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.43,timestamp=3985857606.74,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3985857611.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.1,timestamp=3985857639.76,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.12,timestamp=3985857644.87,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.78,timestamp=3985857672.63,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.29,timestamp=3985857677.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.89,timestamp=3985857706.85,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=3,mg_state=steady,duration=1.51,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857712.13,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=4,mg_state=steady,duration=1.51,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857712.13,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=4,mg_state=steady,duration=0.62,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857712.88,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=4,mg_state=steady,duration=81.32,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857794.25,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.98,timestamp=3985857716.83,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985857718.52,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=8.74,timestamp=3985857733.13,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.24,timestamp=3985857736.19,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3985857737.85,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.95,timestamp=3985857751.65,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857754.63,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.85,timestamp=3985857756.25,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.88,timestamp=3985857769.99,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857773.01,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985857774.67,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.84,timestamp=3985857788.38,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=4,mg_state=steady,duration=0.76,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857795.11,sub_operations=['trace_src_func=allreduce,duration=0.42,timestamp=3985857795.0,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=4,mg_state=steady,duration=141.82,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857937.44,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.82,timestamp=3985857803.74,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.9,timestamp=3985857831.62,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.33,timestamp=3985857836.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.29,timestamp=3985857866.21,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.69,timestamp=3985857871.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.68,timestamp=3985857900.57,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.12,timestamp=3985857905.66,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.2,timestamp=3985857933.81,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=4,mg_state=steady,duration=1.43,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857938.99,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=5,mg_state=steady,duration=1.43,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985857938.99,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=5,mg_state=steady,duration=0.5,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985857939.6,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=5,mg_state=steady,duration=83.09,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858022.75,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.38,timestamp=3985857943.87,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985857945.52,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=9.29,timestamp=3985857960.69,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985857963.65,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.76,timestamp=3985857965.15,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.62,timestamp=3985857978.64,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=2.01,timestamp=3985857983.41,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.88,timestamp=3985857985.01,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.79,timestamp=3985857998.67,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.17,timestamp=3985858001.63,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985858003.28,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.75,timestamp=3985858016.89,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=5,mg_state=steady,duration=0.47,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858023.31,sub_operations=['trace_src_func=allreduce,duration=0.14,timestamp=3985858023.21,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=5,mg_state=steady,duration=139.52,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858163.34,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.75,timestamp=3985858031.92,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.25,timestamp=3985858059.13,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.3,timestamp=3985858064.42,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.66,timestamp=3985858092.06,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.24,timestamp=3985858097.34,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.67,timestamp=3985858126.01,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.34,timestamp=3985858131.35,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.22,timestamp=3985858159.68,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=5,mg_state=steady,duration=1.56,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858165.09,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=6,mg_state=steady,duration=1.56,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858165.09,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=6,mg_state=steady,duration=0.81,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858166.1,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=6,mg_state=steady,duration=79.96,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858246.11,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.14,timestamp=3985858169.88,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.79,timestamp=3985858171.53,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.76,timestamp=3985858185.17,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.9,timestamp=3985858188.93,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3985858190.59,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.75,timestamp=3985858204.21,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985858207.15,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.89,timestamp=3985858208.81,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.74,timestamp=3985858222.41,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3985858225.37,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.82,timestamp=3985858226.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.46,timestamp=3985858240.23,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=6,mg_state=steady,duration=0.96,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858247.17,sub_operations=['trace_src_func=allreduce,duration=0.61,timestamp=3985858247.06,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=6,mg_state=steady,duration=138.76,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858386.46,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.71,timestamp=3985858255.73,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.45,timestamp=3985858283.17,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.83,timestamp=3985858288.02,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.04,timestamp=3985858316.03,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.12,timestamp=3985858321.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.45,timestamp=3985858349.64,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3985858354.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.35,timestamp=3985858383.0,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=6,mg_state=steady,duration=1.48,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858388.06,sub_operations=[])
rank:10:recv_forward(stage_id=1,batch_id=7,mg_state=steady,duration=1.48,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858388.06,sub_operations=[])
rank:10:get_batch(stage_id=1,batch_id=7,mg_state=steady,duration=0.65,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858388.85,sub_operations=[])
rank:10:forward_step(stage_id=1,batch_id=7,mg_state=steady,duration=80.15,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858469.05,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.72,timestamp=3985858392.74,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3985858394.37,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.87,timestamp=3985858408.1,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985858411.03,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3985858412.7,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.42,timestamp=3985858426.0,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.65,timestamp=3985858429.46,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3985858431.16,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.8,timestamp=3985858444.82,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3985858447.86,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3985858449.5,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=7.82,timestamp=3985858463.18,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:loss_func(stage_id=1,batch_id=7,mg_state=steady,duration=0.71,description=loss_func, calculate and DP allreduce for the last stage,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858469.86,sub_operations=['trace_src_func=allreduce,duration=0.37,timestamp=3985858469.75,input__shape=[1],input__dtype=torch.float32,func_name=loss_func,group=dp,comm_func=allreduce'])
rank:10:backward_step(stage_id=1,batch_id=7,mg_state=steady,duration=140.1,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858610.46,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=0.8,timestamp=3985858478.41,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.64,timestamp=3985858506.33,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.69,timestamp=3985858511.09,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=15.32,timestamp=3985858539.37,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.31,timestamp=3985858544.65,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=14.92,timestamp=3985858572.54,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.3,timestamp=3985858577.85,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=16.02,timestamp=3985858606.93,input__shape=[10181, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:10:send_backward(stage_id=1,batch_id=7,mg_state=steady,duration=1.22,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3985858611.79,sub_operations=[])
rank:10:dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=14.81,description=Regular DP gradient synchronization (non-expert parameters),group_kind=dp,input__shape=[374116352],input__dtype=torch.float32,timestamp=3985858626.67,sub_operations=[])
rank:10:ep_dp_allreduce(stage_id=1,batch_id=0,mg_state=finalize,duration=5.64,description=Expert DP gradient synchronization (expert parameters),group_kind=ep_dp,input__shape=[1409286144],input__dtype=torch.float32,timestamp=3985858632.36,sub_operations=[])
rank:10:optimizer_step(stage_id=1,batch_id=0,mg_state=finalize,duration=33.4,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3985858666.0,sub_operations=[])
