rank:6:get_batch(stage_id=0,batch_id=0,mg_state=warmup,duration=0.35,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380981819.08,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=0,mg_state=warmup,duration=75.65,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380981894.8,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.5,timestamp=3380981823.14,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.85,timestamp=3380981824.85,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.03,timestamp=3380981838.44,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.52,timestamp=3380981842.6,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3380981844.27,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.04,timestamp=3380981857.72,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3380981860.74,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380981862.39,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.11,timestamp=3380981875.82,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.35,timestamp=3380981879.22,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380981880.89,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.17,timestamp=3380981894.37,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=0,mg_state=warmup,duration=1.3,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380981896.3,sub_operations=[])
rank:6:get_batch(stage_id=0,batch_id=1,mg_state=steady,duration=0.55,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380981896.99,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=1,mg_state=steady,duration=76.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380981973.65,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.79,timestamp=3380981900.65,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3380981902.39,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.09,timestamp=3380981916.02,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.14,timestamp=3380981920.03,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380981921.72,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.14,timestamp=3380981935.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=2.02,timestamp=3380981940.01,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3380981941.81,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.09,timestamp=3380981955.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.26,timestamp=3380981958.14,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3380981959.78,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.17,timestamp=3380981973.23,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=1,mg_state=steady,duration=150.98,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982124.85,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=0,mg_state=steady,duration=150.98,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982124.85,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=0,mg_state=steady,duration=133.93,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982258.89,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.07,timestamp=3380982127.94,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.2,timestamp=3380982154.78,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.84,timestamp=3380982159.64,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.62,timestamp=3380982186.86,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.87,timestamp=3380982191.65,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.99,timestamp=3380982219.25,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3380982224.13,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.85,timestamp=3380982251.62,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=2,mg_state=steady,duration=0.6,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982259.69,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=2,mg_state=steady,duration=77.68,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982337.43,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.79,timestamp=3380982264.59,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3380982266.35,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.26,timestamp=3380982280.06,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.49,timestamp=3380982284.08,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3380982285.78,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.09,timestamp=3380982299.21,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.69,timestamp=3380982303.87,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3380982305.6,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.13,timestamp=3380982319.05,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.27,timestamp=3380982321.99,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3380982323.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.1,timestamp=3380982337.02,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=2,mg_state=steady,duration=13.01,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982350.91,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=1,mg_state=steady,duration=13.01,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982350.91,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=1,mg_state=steady,duration=136.25,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982487.28,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.62,timestamp=3380982353.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.41,timestamp=3380982381.01,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.84,timestamp=3380982385.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.47,timestamp=3380982413.04,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.85,timestamp=3380982417.92,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.78,timestamp=3380982445.3,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.06,timestamp=3380982450.39,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.42,timestamp=3380982478.41,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=3,mg_state=steady,duration=0.58,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982488.09,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=3,mg_state=steady,duration=76.85,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982565.0,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.5,timestamp=3380982492.55,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3380982494.24,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.58,timestamp=3380982508.25,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.73,timestamp=3380982512.64,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3380982514.37,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.19,timestamp=3380982527.89,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.61,timestamp=3380982531.29,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3380982532.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.24,timestamp=3380982546.5,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.19,timestamp=3380982549.48,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380982551.14,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.16,timestamp=3380982564.58,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=3,mg_state=steady,duration=12.34,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982577.79,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=2,mg_state=steady,duration=12.34,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982577.79,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=2,mg_state=steady,duration=136.92,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982714.79,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.55,timestamp=3380982581.27,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.38,timestamp=3380982608.27,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.84,timestamp=3380982613.14,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.6,timestamp=3380982640.34,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.04,timestamp=3380982645.4,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.45,timestamp=3380982673.47,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.0,timestamp=3380982678.48,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.91,timestamp=3380982706.03,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=4,mg_state=steady,duration=0.49,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982715.44,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=4,mg_state=steady,duration=74.35,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982789.84,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.32,timestamp=3380982718.71,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.67,timestamp=3380982721.14,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.61,timestamp=3380982735.07,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.17,timestamp=3380982737.97,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3380982739.7,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.19,timestamp=3380982753.17,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.17,timestamp=3380982756.06,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3380982759.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=9.93,timestamp=3380982771.31,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.16,timestamp=3380982774.22,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3380982775.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.21,timestamp=3380982789.42,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=4,mg_state=steady,duration=15.76,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982806.02,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=3,mg_state=steady,duration=15.76,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380982806.02,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=3,mg_state=steady,duration=135.03,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982941.13,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.09,timestamp=3380982809.04,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.43,timestamp=3380982836.11,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3380982841.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.84,timestamp=3380982868.63,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3380982873.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.9,timestamp=3380982901.12,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.14,timestamp=3380982906.28,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.35,timestamp=3380982934.23,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=5,mg_state=steady,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380982941.83,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=5,mg_state=steady,duration=75.69,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983017.57,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=2.5,timestamp=3380982947.31,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3380982949.04,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.66,timestamp=3380982963.01,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.24,timestamp=3380982965.98,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3380982967.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.17,timestamp=3380982981.17,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.15,timestamp=3380982984.1,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380982985.74,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.16,timestamp=3380982999.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.15,timestamp=3380983002.06,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380983003.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.17,timestamp=3380983017.16,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=5,mg_state=steady,duration=12.89,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983030.88,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=4,mg_state=steady,duration=12.89,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983030.88,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=4,mg_state=steady,duration=136.68,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983167.63,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.25,timestamp=3380983034.02,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.56,timestamp=3380983061.18,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380983066.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.36,timestamp=3380983094.01,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3380983098.98,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.39,timestamp=3380983126.96,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.07,timestamp=3380983132.01,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.17,timestamp=3380983159.77,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=6,mg_state=steady,duration=0.5,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983168.28,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=6,mg_state=steady,duration=75.44,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983243.78,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.74,timestamp=3380983172.9,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3380983174.62,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.84,timestamp=3380983188.76,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.33,timestamp=3380983191.79,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3380983193.46,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.1,timestamp=3380983206.86,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3380983209.75,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380983211.4,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.1,timestamp=3380983224.82,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.58,timestamp=3380983228.09,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380983229.72,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.18,timestamp=3380983243.28,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=6,mg_state=steady,duration=12.77,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983257.07,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=5,mg_state=steady,duration=12.77,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983257.07,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=5,mg_state=steady,duration=135.59,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983392.75,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.46,timestamp=3380983260.44,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.42,timestamp=3380983287.5,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.82,timestamp=3380983292.33,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.42,timestamp=3380983319.34,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3380983324.23,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.48,timestamp=3380983352.29,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.07,timestamp=3380983357.32,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.15,timestamp=3380983385.07,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=7,mg_state=steady,duration=0.58,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983393.52,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=7,mg_state=steady,duration=75.42,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983468.99,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.86,timestamp=3380983398.55,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.87,timestamp=3380983400.16,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.26,timestamp=3380983413.71,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.32,timestamp=3380983416.74,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3380983418.43,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.21,timestamp=3380983431.95,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.69,timestamp=3380983435.33,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380983436.98,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.16,timestamp=3380983450.43,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.31,timestamp=3380983453.42,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380983455.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.2,timestamp=3380983468.58,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=7,mg_state=steady,duration=16.42,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983485.78,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=6,mg_state=steady,duration=16.42,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983485.78,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=6,mg_state=steady,duration=134.51,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983620.36,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.63,timestamp=3380983489.29,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.4,timestamp=3380983516.3,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.81,timestamp=3380983521.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.54,timestamp=3380983548.2,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.0,timestamp=3380983553.17,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.78,timestamp=3380983580.55,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.2,timestamp=3380983585.71,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.05,timestamp=3380983613.36,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:recv_backward(stage_id=0,batch_id=7,mg_state=cooldown,duration=91.68,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3380983712.33,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=7,mg_state=cooldown,duration=135.12,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983847.52,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.16,timestamp=3380983715.49,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.21,timestamp=3380983742.32,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3380983747.21,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.49,timestamp=3380983774.28,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3380983779.17,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.04,timestamp=3380983806.8,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.07,timestamp=3380983811.83,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.98,timestamp=3380983839.4,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:dp_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=15.15,description=Regular DP gradient synchronization (non-expert parameters),group_kind=dp,input__shape=[374112256],input__dtype=torch.float32,timestamp=3380983862.8,sub_operations=[])
rank:6:ep_dp_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=5.65,description=Expert DP gradient synchronization (expert parameters),group_kind=ep_dp,input__shape=[1409286144],input__dtype=torch.float32,timestamp=3380983868.5,sub_operations=[])
rank:6:optimizer_step(stage_id=0,batch_id=0,mg_state=finalize,duration=33.6,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3380983902.31,sub_operations=[])
