rank:6:get_batch(stage_id=0,batch_id=0,mg_state=warmup,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075520.46,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=0,mg_state=warmup,duration=75.22,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075595.75,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.33,timestamp=3381075524.05,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3381075525.89,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=11.99,timestamp=3381075539.37,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.59,timestamp=3381075543.6,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3381075545.3,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=11.98,timestamp=3381075558.65,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.5,timestamp=3381075561.96,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3381075563.64,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381075577.05,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.27,timestamp=3381075580.33,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381075582.02,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381075595.34,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=0,mg_state=warmup,duration=1.28,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381075597.24,sub_operations=[])
rank:6:get_batch(stage_id=0,batch_id=1,mg_state=steady,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075597.9,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=1,mg_state=steady,duration=75.15,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075673.11,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.71,timestamp=3381075601.53,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381075603.22,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.1,timestamp=3381075616.72,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.73,timestamp=3381075620.93,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3381075622.59,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.12,timestamp=3381075636.07,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3381075639.29,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.87,timestamp=3381075640.96,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381075654.4,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.4,timestamp=3381075657.56,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3381075659.31,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.07,timestamp=3381075672.69,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=1,mg_state=steady,duration=147.26,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381075820.6,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=0,mg_state=steady,duration=147.26,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381075820.6,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=0,mg_state=steady,duration=133.04,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075953.77,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.82,timestamp=3381075823.49,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.26,timestamp=3381075850.37,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.87,timestamp=3381075855.16,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.44,timestamp=3381075882.21,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3381075887.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.74,timestamp=3381075914.4,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381075919.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.78,timestamp=3381075946.57,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=2,mg_state=steady,duration=0.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381075954.58,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=2,mg_state=steady,duration=75.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076030.25,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.53,timestamp=3381075959.11,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.96,timestamp=3381075960.86,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.12,timestamp=3381075974.43,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.28,timestamp=3381075978.34,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3381075980.12,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381075993.52,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.16,timestamp=3381075996.64,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3381075998.32,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.09,timestamp=3381076011.81,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.16,timestamp=3381076014.68,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3381076016.34,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.2,timestamp=3381076029.83,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=2,mg_state=steady,duration=16.63,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076047.3,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=1,mg_state=steady,duration=16.63,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076047.3,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=1,mg_state=steady,duration=136.61,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076183.98,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.96,timestamp=3381076050.13,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.57,timestamp=3381076077.29,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.1,timestamp=3381076082.34,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.81,timestamp=3381076109.75,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3381076114.72,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.89,timestamp=3381076142.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.15,timestamp=3381076147.3,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.29,timestamp=3381076175.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=3,mg_state=steady,duration=0.54,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076184.67,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=3,mg_state=steady,duration=75.33,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076260.06,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.87,timestamp=3381076188.42,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3381076190.18,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.61,timestamp=3381076204.23,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.33,timestamp=3381076208.16,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3381076209.82,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.18,timestamp=3381076223.34,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.42,timestamp=3381076226.55,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3381076228.23,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.09,timestamp=3381076241.71,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.13,timestamp=3381076244.56,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381076246.24,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.1,timestamp=3381076259.64,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=3,mg_state=steady,duration=11.49,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076271.92,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=2,mg_state=steady,duration=11.49,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076271.92,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=2,mg_state=steady,duration=136.18,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076408.19,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.96,timestamp=3381076274.77,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.59,timestamp=3381076301.96,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.02,timestamp=3381076306.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.88,timestamp=3381076334.39,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3381076339.33,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.96,timestamp=3381076366.89,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.07,timestamp=3381076371.92,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.01,timestamp=3381076399.52,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=4,mg_state=steady,duration=0.53,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076409.03,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=4,mg_state=steady,duration=73.55,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076482.64,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.12,timestamp=3381076412.23,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3381076413.91,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.7,timestamp=3381076427.94,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.42,timestamp=3381076431.16,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381076432.83,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.11,timestamp=3381076446.26,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.11,timestamp=3381076449.15,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.91,timestamp=3381076450.8,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381076464.13,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.24,timestamp=3381076467.12,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381076468.79,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.13,timestamp=3381076482.22,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=4,mg_state=steady,duration=14.07,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076497.07,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=3,mg_state=steady,duration=14.07,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076497.07,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=3,mg_state=steady,duration=134.35,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076631.5,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.98,timestamp=3381076499.89,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.36,timestamp=3381076526.84,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.89,timestamp=3381076531.7,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.77,timestamp=3381076559.06,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.17,timestamp=3381076564.19,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.01,timestamp=3381076591.92,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.78,timestamp=3381076596.86,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.2,timestamp=3381076624.66,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=5,mg_state=steady,duration=0.59,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076632.27,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=5,mg_state=steady,duration=77.02,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076709.34,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.96,timestamp=3381076637.37,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3381076639.07,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.24,timestamp=3381076652.62,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3381076655.55,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=2.05,timestamp=3381076658.33,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.2,timestamp=3381076671.85,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.16,timestamp=3381076675.75,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3381076677.41,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.16,timestamp=3381076690.89,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.23,timestamp=3381076693.82,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3381076695.51,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.11,timestamp=3381076708.92,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=5,mg_state=steady,duration=14.33,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076724.07,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=4,mg_state=steady,duration=14.33,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076724.07,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=4,mg_state=steady,duration=135.01,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076859.15,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=2.02,timestamp=3381076726.93,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.41,timestamp=3381076753.93,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3381076758.87,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.71,timestamp=3381076786.17,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3381076791.11,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.7,timestamp=3381076818.4,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.97,timestamp=3381076823.33,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.38,timestamp=3381076851.3,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=6,mg_state=steady,duration=0.62,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076859.92,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=6,mg_state=steady,duration=74.34,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381076934.31,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=1.12,timestamp=3381076863.95,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3381076865.69,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.64,timestamp=3381076879.63,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.22,timestamp=3381076882.59,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3381076884.22,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.13,timestamp=3381076897.66,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.21,timestamp=3381076900.56,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.93,timestamp=3381076902.2,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.22,timestamp=3381076915.74,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.32,timestamp=3381076918.76,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.95,timestamp=3381076920.43,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.15,timestamp=3381076933.89,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=6,mg_state=steady,duration=15.14,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076949.79,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=5,mg_state=steady,duration=15.14,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381076949.79,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=5,mg_state=steady,duration=134.97,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077084.83,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.95,timestamp=3381076952.58,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.61,timestamp=3381076979.79,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3381076984.67,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.63,timestamp=3381077011.89,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3381077016.75,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.77,timestamp=3381077044.11,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.19,timestamp=3381077049.25,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.33,timestamp=3381077077.17,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:get_batch(stage_id=0,batch_id=7,mg_state=steady,duration=0.45,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077085.42,sub_operations=[])
rank:6:forward_step(stage_id=0,batch_id=7,mg_state=steady,duration=75.76,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077161.23,sub_operations=['trace_src_func=_gather_along_first_dim_expert_parallel,duration=2.11,timestamp=3381077090.37,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.92,timestamp=3381077092.04,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.51,timestamp=3381077105.85,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.2,timestamp=3381077108.75,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3381077110.42,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.25,timestamp=3381077123.97,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.45,timestamp=3381077127.13,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.94,timestamp=3381077128.81,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.02,timestamp=3381077142.19,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_gather_along_first_dim_expert_parallel,duration=0.75,timestamp=3381077145.68,input__shape=[16],input__dtype=torch.int64,func_name=gather_along_first_dim_expert_parallel,group=exp,comm_func=allgather', 'trace_src_func=_profiled_all_to_all_single,duration=0.9,timestamp=3381077147.34,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=12.16,timestamp=3381077160.8,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:send_forward(stage_id=0,batch_id=7,mg_state=steady,duration=11.58,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381077173.18,sub_operations=[])
rank:6:recv_backward(stage_id=0,batch_id=6,mg_state=steady,duration=11.58,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381077173.18,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=6,mg_state=steady,duration=133.97,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077307.23,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.97,timestamp=3381077175.99,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.43,timestamp=3381077203.02,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.01,timestamp=3381077208.01,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.84,timestamp=3381077235.44,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.98,timestamp=3381077240.4,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.68,timestamp=3381077267.67,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.99,timestamp=3381077272.61,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.02,timestamp=3381077300.22,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:recv_backward(stage_id=0,batch_id=7,mg_state=cooldown,duration=89.77,description=None,group_kind=pp,input__shape=[4096, 1, 4096],input__dtype=torch.bfloat16,timestamp=3381077397.23,sub_operations=[])
rank:6:backward_step(stage_id=0,batch_id=7,mg_state=cooldown,duration=135.62,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077532.91,sub_operations=['trace_src_func=_profiled_all_to_all_single,duration=1.84,timestamp=3381077399.89,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.36,timestamp=3381077426.85,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.86,timestamp=3381077431.67,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=23.39,timestamp=3381077458.64,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=0.89,timestamp=3381077463.49,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.16,timestamp=3381077491.23,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=1.64,timestamp=3381077496.81,input__shape=[8192, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all', 'trace_src_func=_profiled_all_to_all_single,duration=24.37,timestamp=3381077524.77,input__shape=[1587, 4096],input__dtype=torch.bfloat16,group=exp,comm_func=all_to_all'])
rank:6:dp_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=15.17,description=Regular DP gradient synchronization (non-expert parameters),group_kind=dp,input__shape=[374112256],input__dtype=torch.float32,timestamp=3381077548.18,sub_operations=[])
rank:6:ep_dp_allreduce(stage_id=0,batch_id=0,mg_state=finalize,duration=5.66,description=Expert DP gradient synchronization (expert parameters),group_kind=ep_dp,input__shape=[1409286144],input__dtype=torch.float32,timestamp=3381077553.89,sub_operations=[])
rank:6:optimizer_step(stage_id=0,batch_id=0,mg_state=finalize,duration=33.6,description=None,group_kind=None,input__shape=None,input__dtype=None,timestamp=3381077587.68,sub_operations=[])
